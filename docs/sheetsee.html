<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="description" content="sheetsee.js, google, spreadsheet, visualize, data, javascript">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>such site, very sheetsee.js</title>
    <link href='http://fonts.googleapis.com/css?family=Libre+Baskerville:400,700,400italic' rel='stylesheet' type='text/css'>
    <link rel="shortcut icon" href=""/>
    <link href='../assets/style.css' rel='stylesheet'>
  </head>
  <body>
    <div class="container">
    <h1 id="sheetsee">sheetsee</h1>
<p>This is the core module to create a sheetsee.js library. It contains the functions for building your custom file as well as the basic data manipulation functions.</p>
<h2 id="working-with-your-data">Working With Your Data</h2>
<p>Tabletop.js will return all of your data and it will be passed into your site as an <em>array of objects</em> called <strong>gData</strong>. Sheetsee.js has functions built in to help you filter or use that data in other ways if you&#39;d like.</p>
<h3 id="sheetsee-getgroupcount-data-groupterm-">Sheetsee.getGroupCount(data, groupTerm)</h3>
<p>This takes in your data, an <em>array of objects</em>, and searches for a <em>string</em>, <strong>groupTerm</strong>, in each piece of your <strong>data</strong> (formerly the cells of your spreadsheet). It returns the number of times it found the <strong>groupTerm</strong>.</p>
<pre><code class="lang-javascript">getGroupCount(gData, &quot;cat&quot;)
// returns 2
</code></pre>
<h3 id="sheetsee-getcolumntotal-data-column-">Sheetsee.getColumnTotal(data, column)</h3>
<p>Given your <strong>data</strong>, an <em>array of objects</em> and a <em>string</em> <strong>column</strong> header, this functions sums each cell in that column, so they best be numbers.</p>
<pre><code class="lang-javascript">getColumnTotal(gData, &quot;cuddlability&quot;)
// returns 11
</code></pre>
<h3 id="sheetsee-getaveragefromcolumn-data-column-">Sheetsee.getAveragefromColumn(data, column)</h3>
<p>A really simple function that builds on <code>getColumnTotal()</code> by returning the average number in a <strong>column</strong> of numbers.</p>
<pre><code class="lang-javascript">getColumnAverage(gData, &quot;cuddlability&quot;)
// returns 1.8333333333333333
</code></pre>
<h3 id="sheetsee-getmin-data-column-">Sheetsee.getMin(data, column)</h3>
<p>This will return an <em>array</em> of <em>object</em> or <em>objects</em> (if there is a tie) of the element with the lowest number value in the <strong>column</strong> you specify from your <strong>data</strong>.</p>
<pre><code class="lang-javascript">getMin(gData, &quot;cuddlability&quot;)
// returns {breed: &quot;Fat&quot;, cuddlability: &quot;0&quot;, hexcolor: &quot;#CDCF83&quot;...}, {breed: &quot;Grey&quot;, cuddlability: &quot;0&quot;, hexcolor: &quot;#9C9B9A&quot;...}, {breed: &quot;Creepy&quot;, cuddlability: &quot;0&quot;, hexcolor: &quot;#918376&quot;...}
</code></pre>
<h3 id="sheetsee-getmax-data-column-">Sheetsee.getMax(data, column)</h3>
<p>This will return an <em>array</em> of <em>object</em> or <em>objects</em> (if there is a tie) of the element with the highest number value in the <strong>column</strong> you specify from your <strong>data</strong>.</p>
<pre><code class="lang-javascript">getMin(gData, &quot;cuddlability&quot;)
// returns {breed: &quot;Teacup Maltese&quot;, cuddlability: &quot;5&quot;, hexcolor: &quot;#ECECEC&quot;, kind: &quot;Dog&quot;, lat: &quot;37.74832&quot;, long: &quot;-122.402158&quot;, name: &quot;Coco&quot;...}
</code></pre>
<h3 id="don-t-forget-javascript-math">Don&#39;t Forget JavaScript Math</h3>
<p>Create variables that are the sums, differences, multiples and so forth of others. Lots of info on that <a href="https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Global_Objects/Math">here on MDN</a>.</p>
<pre><code class="lang-javascript">var profit09 = Sheetsee.getColumnTotal(gData, &quot;2009&quot;)
var profit10 = Sheetsee.getColumnTotal(gData, &quot;2010&quot;)
var difference = profit09 - profit10
</code></pre>
<h4 id="what-these-little-bits-are-good-for">What These Little Bits are Good For</h4>
<p>You don&#39;t have to just create tables of your data. You can have other portions of your page that show things like, &quot;The difference taco consumption between last week and this week is...&quot; These are easy to create with javascirpt math functions and knowing a little bit more about <a href="http://icanhazjs.com/">icanhas.js</a>. View source on this page to see how I created &quot;Most Cuddlable&quot;.</p>
<h3 id="sheetsee-getmatches-data-filter-category-">Sheetsee.getMatches(data, filter, category)</h3>
<p>Takes <strong>data</strong> as an <em>array of objects</em>, a <em>string</em> you&#39;d like to <strong>filter</strong> and a <em>string</em> of the <strong>category</strong> you want it to look in (a column header from your spreadsheet).</p>
<pre><code class="lang-javascript">getMatches(gData, &quot;dog&quot;, &quot;kind&quot;)
</code></pre>
<p>Returns an <em>array of objects</em> matching the category&#39;s filter.</p>
<pre><code class="lang-javascript">[{&quot;name&quot;: &quot;coco&quot;, &quot;kind&quot;: &quot;dog&quot;...}, {&quot;name&quot;: &quot;wolfgang&quot;, &quot;kind&quot;: &quot;dog&quot;...},{&quot;name&quot;: &quot;cooc&quot;, &quot;kind&quot;: &quot;dog&quot;...} ]
</code></pre>
<h3 id="sheetsee-getoccurance-data-category-">Sheetsee.getOccurance(data, category)</h3>
<p>Takes <strong>data</strong> as an <em>array of objects</em> and a <em>string</em> for <strong>category</strong> (a column header from your spreadsheet) you want tally how often an element occured.</p>
<pre><code class="lang-javascript">getOccurance(gData, &quot;kind&quot;)
</code></pre>
<p>Returns an object with keys and values for each variation of the category and its occurance.</p>
<pre><code class="lang-javascript">{&quot;dog&quot;: 3, &quot;cat&quot;: 3}
</code></pre>
<h3 id="sheetsee-makecolorarrayofobject-data-colors-">Sheetsee.makeColorArrayOfObject(data, colors)</h3>
<p>If you use <code>getOccurance()</code> and want to then chart that data with d3.js, you&#39;ll need to make it into an <em>array</em> (instead of an object) and add colors back in (since the hexcolor column applies to the datapoints in your original dataset and not this new dataset).</p>
<p>This function takes in your data, as an <em>object</em>, and an <em>array</em> of hexidecimal color strings which you define.</p>
<pre><code class="lang-javascript">var kinds = getOccurance(gData, &quot;kind&quot;)
var kindColors = [&quot;#ff00ff&quot;, &quot;#DCF13C&quot;]

var kindData = makeColorArrayOfObjects(mostPopBreeds, breedColors)
</code></pre>
<p>It will return an array of objects formatted to go directly into a d3 chart with the appropriate <em>units</em> and <em>label keys</em>, like so:</p>
<pre><code class="lang-javascript">[{&quot;label&quot;: &quot;dog&quot;, &quot;units&quot;: 2, &quot;hexcolor&quot;: &quot;#ff00ff&quot;}, {&quot;label&quot;: &quot;cat&quot;, &quot;units&quot;: 3, &quot;hexcolor&quot;: &quot;#DCF13C&quot;}]
</code></pre>
<p>If you pass in an array of just one color it will repeat that color for all items. If you pass fewer colors than data elements it will repeat the sequences of colors for the remainder elements.</p>
<h3 id="sheetsee-addunitslabels-arrayobj-oldlabel-oldunits-">Sheetsee.addUnitsLabels(arrayObj, oldLabel, oldUnits)</h3>
<p>If you&#39;re using gData, the data directly from Tabletop, you&#39;ll need to format it before you use the d3 charts. You&#39;ll need to determine what part of your data you want to chart - what will be your label, what your charting, and what will be your units, how many of them are there (this should be a number).</p>
<pre><code class="lang-javascript">var gData =  [{&quot;name&quot;: &quot;coco&quot;, &quot;kind&quot;: &quot;dog&quot;, &quot;cuddablity&quot;: 5}, {&quot;name&quot;: &quot;unagi&quot;, &quot;kind&quot;: &quot;cat&quot;, &quot;cuddlability&quot;: 0}]
</code></pre>
<p>For istance, if from our original data above we want to chart the age of each cat, we&#39;ll use:</p>
<pre><code class="lang-javascript">Sheetsee.addUnitsLabels(gData, &quot;name&quot;, &quot;cuddlability&quot;)
</code></pre>
<p>Which will return an array, ready for the d3 charts:</p>
<pre><code class="lang-javascript">[{&quot;label&quot;: &quot;coco&quot;, &quot;kind&quot;: &quot;dog&quot;, &quot;units&quot;: 5}, {&quot;label&quot;: &quot;unagi&quot;, &quot;kind&quot;: &quot;cat&quot;, &quot;units&quot;: 0}]
</code></pre>

    </div>
  </body>
</html>